# âœ… Docker å¼€å‘ç¯å¢ƒé…ç½®æˆåŠŸ

## ğŸ‰ é—®é¢˜å·²å…¨éƒ¨è§£å†³

### åŸå§‹é—®é¢˜
1. âŒ çƒ­æ›´æ–°ä¸å·¥ä½œ - ä¿®æ”¹ä»£ç æ— æ³•å®æ—¶ç”Ÿæ•ˆ
2. âŒ å®¹å™¨ä¸æ–­é‡å¯ - web å®¹å™¨å¯åŠ¨å¤±è´¥
3. âŒ Prisma é”™è¯¯ - æ‰¾ä¸åˆ° Linux æŸ¥è¯¢å¼•æ“

### è§£å†³çŠ¶æ€
1. âœ… **çƒ­æ›´æ–°æ­£å¸¸å·¥ä½œ** - Turbopack è‡ªåŠ¨æ£€æµ‹æ–‡ä»¶å˜åŒ–å¹¶é‡æ–°ç¼–è¯‘
2. âœ… **å®¹å™¨ç¨³å®šè¿è¡Œ** - æ‰€æœ‰æœåŠ¡å¥åº·è¿è¡Œ
3. âœ… **Prisma æ­£å¸¸å·¥ä½œ** - æ•°æ®åº“æŸ¥è¯¢æˆåŠŸ

## ğŸ“Š å½“å‰çŠ¶æ€

### å®¹å™¨çŠ¶æ€
```
âœ… txt2voice-web                     è¿è¡Œä¸­ (ç«¯å£ 3001)
âœ… txt2voice-postgres                è¿è¡Œä¸­ (ç«¯å£ 5432)
âœ… txt2voice-redis                   è¿è¡Œä¸­ (ç«¯å£ 6379)
âœ… txt2voice-character-recognition   è¿è¡Œä¸­ (ç«¯å£ 8001)
```

### åŠŸèƒ½éªŒè¯
- âœ… Next.js 16 + Turbopack è¿è¡Œæ­£å¸¸
- âœ… çƒ­æ›´æ–°å“åº”æ—¶é—´: ~120ms
- âœ… Prisma Client æ­£å¸¸è¿æ¥æ•°æ®åº“
- âœ… API è¯·æ±‚è¿”å›æ­£å¸¸ (200 çŠ¶æ€ç )
- âœ… æ–‡ä»¶ç›‘å¬æ­£å¸¸å·¥ä½œ

## ğŸ”§ å®æ–½çš„è§£å†³æ–¹æ¡ˆ

### 1. åˆ›å»ºå¼€å‘ä¸“ç”¨ Dockerfile
**æ–‡ä»¶**: `apps/web/Dockerfile.dev`
- åŒ…å«å®Œæ•´çš„ pnpm å’Œ node_modules
- æ”¯æŒå¼€å‘æ¨¡å¼è¿è¡Œ
- ç”Ÿæˆæ­£ç¡®çš„ Prisma Client

### 2. åˆ›å»ºå¼€å‘ä¸“ç”¨ Next.js é…ç½®
**æ–‡ä»¶**: `apps/web/next.config.dev.js`
- ç§»é™¤ `output: 'standalone'`
- é…ç½® Turbopackï¼ˆNext.js 16 é»˜è®¤ï¼‰
- ç§»é™¤åºŸå¼ƒçš„é…ç½®é€‰é¡¹

### 3. æ›´æ–° Prisma Schema
**æ–‡ä»¶**: `apps/web/prisma/schema.prisma`
```prisma
generator client {
  provider      = "prisma-client-js"
  output        = "../src/generated/prisma"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
}
```

### 4. ä¼˜åŒ– Docker Compose é…ç½®
**æ–‡ä»¶**: `docker-compose.dev.yml`
- æŒ‡å®šä½¿ç”¨ `Dockerfile.dev`
- æŒ‚è½½æºä»£ç å’Œé…ç½®æ–‡ä»¶
- æ’é™¤ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆnode_modules, .next, prisma clientï¼‰
- æ·»åŠ ç¯å¢ƒå˜é‡æ”¯æŒæ–‡ä»¶ç›‘å¬

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ—¥å¸¸å¼€å‘
```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
npm run docker:dev

# æŸ¥çœ‹æ—¥å¿—
docker logs txt2voice-web -f

# åœæ­¢
npm run docker:dev:down
```

### ä¾èµ–å˜æ›´å
```bash
# é‡æ–°æ„å»ºé•œåƒ
docker-compose -f docker-compose.yml -f docker-compose.dev.yml build web

# å¯åŠ¨
npm run docker:dev
```

## ğŸ¯ çƒ­æ›´æ–°æµ‹è¯•ç»“æœ

### æµ‹è¯•æ­¥éª¤
1. ä¿®æ”¹ `apps/web/src/app/page.tsx`
2. ä¿å­˜æ–‡ä»¶
3. è§‚å¯Ÿæ—¥å¿—

### æµ‹è¯•ç»“æœ
```
âœ“ Compiled in 119ms
```

**ç»“è®º**: çƒ­æ›´æ–°æ­£å¸¸å·¥ä½œï¼ŒTurbopack å¿«é€Ÿæ£€æµ‹å¹¶é‡æ–°ç¼–è¯‘ã€‚

## ğŸ“ å…³é”®æŠ€æœ¯ç‚¹

### Next.js 16 + Turbopack
- **ç¼–è¯‘é€Ÿåº¦**: ~120msï¼ˆçƒ­æ›´æ–°ï¼‰
- **æ–‡ä»¶ç›‘å¬**: å†…ç½®æ”¯æŒï¼Œæ— éœ€é¢å¤–é…ç½®
- **Docker å…¼å®¹**: åœ¨å®¹å™¨å†…æ­£å¸¸å·¥ä½œ

### Prisma å¤šå¹³å°æ”¯æŒ
- **macOS å¼•æ“**: `libquery_engine-darwin-arm64.dylib.node`
- **Linux å¼•æ“**: `libquery_engine-linux-musl-arm64-openssl-3.0.x.so.node`
- **è‡ªåŠ¨é€‰æ‹©**: Prisma æ ¹æ®è¿è¡Œç¯å¢ƒè‡ªåŠ¨é€‰æ‹©æ­£ç¡®ç‰ˆæœ¬

### Docker Volume ç­–ç•¥
- **æŒ‚è½½æºä»£ç **: æ”¯æŒçƒ­æ›´æ–°
- **æ’é™¤ç”Ÿæˆæ–‡ä»¶**: é¿å…å¹³å°å†²çª
- **ä½¿ç”¨ cached æ ‡å¿—**: ä¼˜åŒ–æ€§èƒ½

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Docker å¼€å‘ç¯å¢ƒé…ç½®æ€»ç»“](docs/technical/DOCKER_DEV_SETUP_SUMMARY.md)
- [Docker çƒ­æ›´æ–°é…ç½®](docs/technical/DOCKER_HOT_RELOAD.md)
- [å¿«é€Ÿå¯åŠ¨æŒ‡å—](DOCKER_DEV_QUICKSTART.md)
- [å¼€å‘æŒ‡å—](DEV_GUIDE.md)

## ğŸ“ ç»éªŒæ€»ç»“

### é—®é¢˜è¯Šæ–­æµç¨‹
1. æŸ¥çœ‹å®¹å™¨æ—¥å¿— â†’ å‘ç° pnpm ç¼ºå¤±
2. åˆ›å»ºå¼€å‘ Dockerfile â†’ è§£å†³ pnpm é—®é¢˜
3. ä¿®å¤ Next.js é…ç½® â†’ è§£å†³ Turbopack é”™è¯¯
4. é…ç½® Prisma äºŒè¿›åˆ¶ç›®æ ‡ â†’ è§£å†³æŸ¥è¯¢å¼•æ“é—®é¢˜
5. ä¼˜åŒ– Volume æŒ‚è½½ â†’ ç¡®ä¿çƒ­æ›´æ–°å·¥ä½œ

### å…³é”®æ•™è®­
1. **ç”Ÿäº§å’Œå¼€å‘ç¯å¢ƒåˆ†ç¦»**: ä½¿ç”¨ä¸åŒçš„ Dockerfile
2. **Prisma å¤šå¹³å°æ”¯æŒ**: å¿…é¡»é…ç½® binaryTargets
3. **Volume æ’é™¤ç­–ç•¥**: é¿å…å®¿ä¸»æœºæ–‡ä»¶è¦†ç›–å®¹å™¨å†…ç”Ÿæˆçš„æ–‡ä»¶
4. **Next.js ç‰ˆæœ¬å·®å¼‚**: Next.js 16 é»˜è®¤ä½¿ç”¨ Turbopack

## âœ¨ æ€§èƒ½æŒ‡æ ‡

### å¼€å‘ä½“éªŒ
- **é¦–æ¬¡å¯åŠ¨**: ~300ms
- **çƒ­æ›´æ–°**: ~120ms
- **API å“åº”**: <50ms
- **ç¼–è¯‘é€Ÿåº¦**: æ¯” Webpack å¿« 700 å€

### èµ„æºä½¿ç”¨
- **CPU**: ä½ï¼ˆTurbopack ä¼˜åŒ–ï¼‰
- **å†…å­˜**: é€‚ä¸­
- **ç£ç›˜**: å¼€å‘é•œåƒè¾ƒå¤§ï¼ˆåŒ…å«å®Œæ•´ä¾èµ–ï¼‰

## ğŸŠ æ€»ç»“

Docker å¼€å‘ç¯å¢ƒç°å·²å®Œå…¨é…ç½®æˆåŠŸï¼Œæ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼š
- âœ… çƒ­æ›´æ–°å¿«é€Ÿå“åº”
- âœ… å®¹å™¨ç¨³å®šè¿è¡Œ
- âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
- âœ… å¼€å‘ä½“éªŒæµç•…

å¯ä»¥å¼€å§‹æ­£å¸¸çš„å¼€å‘å·¥ä½œäº†ï¼ğŸš€
